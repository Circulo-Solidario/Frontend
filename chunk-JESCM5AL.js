import{a as K,b as Q}from"./chunk-4RUQD4IH.js";import"./chunk-IUTEPSDB.js";import{a as X}from"./chunk-SGMXIVTQ.js";import"./chunk-RSHBZTWH.js";import{a as q,b as O,c as B,d as H,e as U,f as j}from"./chunk-TY7W5LNW.js";import{a as z,b as $}from"./chunk-WNWYPXJT.js";import"./chunk-J7ZDMBSI.js";import{a as N,b as G}from"./chunk-CYTZBTDE.js";import"./chunk-2XCJVA3X.js";import"./chunk-6A5XL65D.js";import"./chunk-7AHVG7ZA.js";import"./chunk-BOTTEXY6.js";import"./chunk-FQGKTMLL.js";import"./chunk-DTLGCBUS.js";import"./chunk-7QH3DEV4.js";import{a as J}from"./chunk-DW6VR7TT.js";import"./chunk-7QJ2EETJ.js";import"./chunk-EL5SIMWJ.js";import"./chunk-FKOEVO4B.js";import"./chunk-M7F2YWVM.js";import{a as A}from"./chunk-D5OLY3RM.js";import{C as I,D as F}from"./chunk-CQCVERZP.js";import"./chunk-4G3JCKZK.js";import"./chunk-4O3FVBGX.js";import{D as W,w as k,x as D}from"./chunk-QOJUQ6XD.js";import{Bb as d,Cb as _,Db as E,Ec as f,Fb as L,Gb as M,Hb as p,Ib as n,Jb as o,Kb as m,Rb as b,Wb as C,Xa as P,Xb as r,Za as a,ea as v,gc as R,ja as x,jb as V,jc as l,ka as g,la as y,lc as h,ma as w,pb as T}from"./chunk-A4JG42N6.js";function Z(e,i){if(e&1){let t=b();n(0,"i",12),C("click",function(){x(t);let s=r();return g(s.goHome())}),o()}}function tt(e,i){e&1&&m(0,"router-outlet")}function et(e,i){e&1&&(n(0,"p-tab",13),l(1,"Mis productos"),o())}function it(e,i){e&1&&(n(0,"p-tab",14),l(1,"Mis solicitudes"),o())}function nt(e,i){e&1&&m(0,"p-divider")}function ot(e,i){if(e&1&&m(0,"p-avatar",19),e&2){let t=r().$implicit;p("image",t.solicitud.solicitante.urlImagen)}}function at(e,i){e&1&&m(0,"p-avatar",20)}function lt(e,i){if(e&1&&m(0,"p-avatar",19),e&2){let t=r(2).$implicit;p("image",t==null?null:t.solicitud.producto.urlImagen)}}function rt(e,i){e&1&&m(0,"p-avatar",29)}function st(e,i){if(e&1&&(n(0,"div",26)(1,"div",27),l(2,"Producto solicitado"),o(),n(3,"div",28),d(4,lt,1,1,"p-avatar",19)(5,rt,1,0,"p-avatar",29),n(6,"div",30)(7,"div",22),l(8),o(),n(9,"span",23),l(10),o()()()()),e&2){let t=r().$implicit;a(4),_(t!=null&&t.solicitud.producto.urlImagen?4:5),a(4),h(" ",t==null?null:t.solicitud.producto.nombre," "),a(2),h(" ",t==null?null:t.solicitud.producto.categoria.nombre," ")}}function ct(e,i){if(e&1){let t=b();d(0,nt,1,0,"p-divider"),n(1,"div",16),C("click",function(){let s=x(t).$implicit,u=r(4);return g(u.loadChat(s))}),n(2,"div",17)(3,"div",18),d(4,ot,1,1,"p-avatar",19)(5,at,1,0,"p-avatar",20),o(),n(6,"div",21)(7,"div",22),l(8),o(),n(9,"span",23),l(10),o()(),n(11,"div",24)(12,"p-button",25),C("click",function(s){let u=x(t).$implicit,S=r(4);return g(S.seeProductDetail(u==null?null:u.solicitud.id,s))}),o()()(),d(13,st,11,3,"div",26),o()}if(e&2){let t=i.$implicit,c=i.$index,s=r(4);_(c!=0?0:-1),a(2),R("pb-0",s.productDetailsVisible.includes(t==null?null:t.solicitud.id)),a(2),_(t.solicitud.solicitante.urlImagen?4:5),a(4),h(" ",t==null?null:t.solicitud.solicitante.alias," "),a(2),h(" ",t==null?null:t.solicitud.solicitante.nombreApellido," "),a(2),p("icon",s.productDetailsVisible.includes(t==null?null:t.solicitud.id)?"pi pi-angle-up":"pi pi-angle-down")("rounded",!0),a(),_(s.productDetailsVisible.includes(t==null?null:t.solicitud.id)?13:-1)}}function dt(e,i){if(e&1&&L(0,ct,14,9,null,null,E),e&2){let t=r(3);M(t.myProductsChats)}}function _t(e,i){e&1&&(n(0,"div",31),y(),n(1,"svg",32)(2,"metadata"),l(3,"Created by potrace 1.10, written by Peter Selinger 2001-2011"),o(),n(4,"g",33),m(5,"path",34)(6,"path",35)(7,"path",36)(8,"path",37)(9,"path",38)(10,"path",39),o()(),w(),n(11,"h2",40),l(12,"Sin chats"),o(),n(13,"span",40),l(14,"No tienes chats pendientes..."),o()())}function mt(e,i){if(e&1&&(n(0,"p-tabpanel",13)(1,"p-dataview",15,0),T(3,dt,2,0,"ng-template",null,1,f)(5,_t,15,0,"ng-template",null,2,f),o()()),e&2){let t=r(2);a(),p("value",t.myProductsChats)}}function pt(e,i){e&1&&m(0,"p-divider")}function ut(e,i){if(e&1&&m(0,"p-avatar",19),e&2){let t=r().$implicit;p("image",t==null?null:t.solicitud.donador.urlImagen)}}function ht(e,i){e&1&&m(0,"p-avatar",41)}function Ct(e,i){if(e&1&&m(0,"p-avatar",19),e&2){let t=r(2).$implicit;p("image",t==null?null:t.solicitud.producto.urlImagen)}}function vt(e,i){e&1&&m(0,"p-avatar",29)}function xt(e,i){if(e&1&&(n(0,"div",26)(1,"div",27),l(2,"Producto solicitado"),o(),n(3,"div",28),d(4,Ct,1,1,"p-avatar",19)(5,vt,1,0,"p-avatar",29),n(6,"div",30)(7,"div",22),l(8),o(),n(9,"span",23),l(10),o()()()()),e&2){let t=r().$implicit;a(4),_(t!=null&&t.solicitud.producto.urlImagen?4:5),a(4),h(" ",t==null?null:t.solicitud.producto.nombre," "),a(2),h(" ",t==null?null:t.solicitud.producto.categoria.nombre," ")}}function gt(e,i){if(e&1){let t=b();d(0,pt,1,0,"p-divider"),n(1,"div",16),C("click",function(){let s=x(t).$implicit,u=r(4);return g(u.loadChat(s))}),n(2,"div",17)(3,"div",18),d(4,ut,1,1,"p-avatar",19)(5,ht,1,0,"p-avatar",41),o(),n(6,"div",21)(7,"div",22),l(8),o(),n(9,"span",23),l(10),o()(),n(11,"div",24)(12,"p-button",25),C("click",function(s){let u=x(t).$implicit,S=r(4);return g(S.seeProductDetail(u==null?null:u.solicitud.id,s))}),o()()(),d(13,xt,11,3,"div",26),o()}if(e&2){let t=i.$implicit,c=i.$index,s=r(4);_(c!=0?0:-1),a(2),R("pb-0",s.productDetailsVisible.includes(t==null?null:t.solicitud.id)),a(2),_(t!=null&&t.solicitud.donador.urlImagen?4:5),a(4),h(" ",t.solicitud.donador.alias," "),a(2),h(" ",t==null?null:t.solicitud.donador.nombreApellido," "),a(2),p("icon",s.productDetailsVisible.includes(t==null?null:t.solicitud.id)?"pi pi-angle-up":"pi pi-angle-down")("rounded",!0),a(),_(s.productDetailsVisible.includes(t==null?null:t.solicitud.id)?13:-1)}}function ft(e,i){if(e&1&&L(0,gt,14,9,null,null,E),e&2){let t=r(3);M(t.myRequetsChats)}}function bt(e,i){e&1&&(n(0,"div",31),y(),n(1,"svg",32)(2,"metadata"),l(3,"Created by potrace 1.10, written by Peter Selinger 2001-2011"),o(),n(4,"g",33),m(5,"path",34)(6,"path",35)(7,"path",36)(8,"path",37)(9,"path",38)(10,"path",39),o()(),w(),n(11,"h2",40),l(12,"Sin chats"),o(),n(13,"span",40),l(14,"No tienes chats pendientes..."),o()())}function St(e,i){if(e&1&&(n(0,"p-tabpanel",14)(1,"p-dataview",15,0),T(3,ft,2,0,"ng-template",null,1,f)(5,bt,15,0,"ng-template",null,2,f),o()()),e&2){let t=r(2);a(),p("value",t.myRequetsChats)}}function yt(e,i){if(e&1&&(n(0,"p-tabs",10)(1,"p-tablist"),d(2,et,2,0,"p-tab",13),d(3,it,2,0,"p-tab",14),o(),n(4,"p-tabpanels"),d(5,mt,7,1,"p-tabpanel",13),d(6,St,7,1,"p-tabpanel",14),o()()),e&2){let t=r();p("value",t.defaultTab),a(2),_(t.canSeeMyProductsChats?2:-1),a(),_(t.canSeeMyRequestsChats?3:-1),a(2),_(t.canSeeMyProductsChats?5:-1),a(),_(t.canSeeMyRequestsChats?6:-1)}}var Y=class e{loginService=v(A);roomService=v(X);toasts=v(W);router=v(D);permissionsService=v(J);screenWidth=window.innerWidth;currentRoute="";myProductsChats=[];myRequetsChats=[];logedUser;defaultTab="0";canSeeMyProductsChats=!1;canSeeMyRequestsChats=!1;productDetailsVisible=[];onResize(){this.screenWidth=window.innerWidth}ngOnInit(){this.loginService.getLoggedUser().subscribe(i=>{if(this.logedUser=i,i==null){this.router.navigate(["/login"]);return}if(!this.permissionsService.canAccessRoute(i,this.router.url)){this.router.navigate(["/principal"]);return}this.logedUser.roles.some(t=>t.id===2)&&(this.canSeeMyProductsChats=!0),this.logedUser.roles.some(t=>t.id===3)&&(this.canSeeMyRequestsChats=!0,this.defaultTab=this.canSeeMyProductsChats?"0":"1"),history.state.goMyProductsChatsTab&&(this.defaultTab="1")}),this.getRequesterRooms(),this.getDonorRooms(),this.router.events.subscribe(()=>{this.currentRoute=this.router.url}),this.currentRoute=this.router.url,this.roomService.reloadRooms$.subscribe(()=>{this.getRequesterRooms(),this.getDonorRooms()})}seeProductDetail(i,t){if(t.stopPropagation(),this.productDetailsVisible.includes(i)){this.productDetailsVisible=this.productDetailsVisible.filter(c=>c!==i);return}this.productDetailsVisible.push(i)}getRequesterRooms(){this.roomService.getRequesterRooms(this.logedUser?.id).subscribe({next:i=>{this.myRequetsChats=i},error:()=>{this.toasts.showToast({severity:"error",summary:"Error al obtener chats",detail:"Error al obtener los chats que corresponden a sus solicitudes, intente nuevamente..."})}})}getDonorRooms(){this.roomService.getDonorRooms(this.logedUser?.id).subscribe({next:i=>{this.myProductsChats=i},error:()=>{this.toasts.showToast({severity:"error",summary:"Error al obtener chats",detail:"Error al obtener los chats que corresponden a las solicitudes de sus productos, intente nuevamente..."})}})}loadChat(i){this.roomService.setChat(i),this.router.navigate(["/principal/chats/mensajes"])}goHome(){this.router.navigate(["/principal"])}shouldShowMobileVersion(){return this.currentRoute.includes("/principal/chats/mensajes")&&this.screenWidth<767}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=V({type:e,selectors:[["app-chat-list"]],hostBindings:function(t,c){t&1&&C("resize",function(){return c.onResize()},P)},decls:12,vars:2,consts:[["dv",""],["list",""],["emptymessage",""],[1,"main-container","container-fluid"],[1,"container-fluid","d-flex","flex-column","justify-content-start","align-items-stretch","h-100","p-0"],[1,"d-flex","p-0","mb-4","flex-shrink-0"],[1,"d-flex","align-items-center","m-0"],[1,"pi","pi-chevron-left","me-3","go-back-buttom"],[1,"d-flex","p-0","flex-grow-1","overflow-hidden"],[1,"col-12","col-md-auto","p-0","pe-3","chat-list"],[3,"value"],[1,"d-none","d-md-block","flex-grow-1","ps-3","overflow-auto"],[1,"pi","pi-chevron-left","me-3","go-back-buttom",3,"click"],["value","0"],["value","1"],[1,"my-requests",3,"value"],[1,"chat-link",3,"click"],[1,"d-flex","align-items-center","px-2","py-3"],[1,"col-auto","me-2"],["size","large","shape","circle",3,"image"],["size","large","shape","circle","icon","pi pi-user"],[1,"col-auto","d-block"],[1,"fw-medium","fs-5"],[1,"fw-medium","text-secondary","fs-6"],[1,"col","d-flex","justify-content-end","me-2"],["variant","outlined","severity","secondary","raised","true",3,"click","icon","rounded"],[1,"col-12","px-2","py-3","product-detail-card"],[1,"fw-semibold","fs-6","mb-2"],[1,"d-flex","flex-row","align-items-center"],["size","large","shape","circle","icon","pi pi-box"],[1,"ms-3","d-block"],[1,"d-block","row","py-3","px-2","justify-content-center","text-center"],["version","1.0","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 210 250","id","no-data-logo","width","75","height","75"],["transform","translate(0.000000,256.000000) scale(0.050000,-0.050000)","stroke","none"],["d","M2885 5114 c-220 -31 -373 -77 -528 -156 -407 -209 -693 -590 -784 -1045 -24 -123 -24 -413 0 -536 49 -244 180 -520 323 -680 19 -20 34 -40 34 -44 0 -4 -59 -67 -132 -140 l-131 -131 -39 26 c-47 30 -127 40 -184 22 -32 -10 -169 -142 -711 -683 -474 -473 -679 -685 -698 -719 -60 -110 -41 -234 49 -324 90 -90 214 -109 324 -49 34 19 246 224 719 698 541 542 673 679 683 711 18 57 8 137 -22 184 l-26 39 133 133 c124 123 135 132 153 119 10 -8 59 -45 108 -82 158 -120 380 -217 604 -264 118 -24 409 -24 533 0 607 121 1071 588 1183 1192 26 137 26 383 0 520 -111 597 -574 1069 -1162 1185 -104 21 -355 35 -429 24z m385 -149 c278 -54 496 -170 700 -375 206 -205 320 -419 376 -705 27 -134 24 -367 -5 -505 -74 -350 -283 -660 -573 -851 -114 -75 -157 -97 -278 -142 -159 -59 -280 -80 -465 -80 -182 0 -299 19 -458 77 -117 43 -169 69 -285 145 -295 194 -510 519 -578 871 -24 127 -24 361 0 485 35 183 107 360 211 515 57 85 200 238 278 298 198 153 434 251 679 282 98 12 294 5 398 -15z m-1653 -2728 c95 -95 95 -106 6 -198 l-67 -70 -103 103 -104 103 70 68 c92 90 102 89 198 -6z m-709 -915 c-443 -443 -560 -555 -591 -564 -99 -30 -201 65 -182 170 6 32 77 107 563 594 l557 558 102 -102 103 -103 -552 -553z"],["d","M2915 4833 c-130 -11 -309 -64 -438 -130 -60 -30 -160 -96 -188 -124 -25 -25 -24 -64 1 -89 28 -28 59 -25 106 9 254 187 592 251 899 170 369 -96 660 -387 754 -754 80 -310 17 -645 -170 -899 -34 -47 -37 -78 -9 -106 25 -25 64 -26 89 -1 53 53 129 185 181 315 75 189 96 456 51 664 -108 509 -520 882 -1040 942 -83 10 -153 10 -236 3z"],["d","M2102 4393 c-18 -7 -103 -135 -144 -218 -199 -399 -155 -890 113 -1245 347 -459 973 -608 1484 -352 90 45 211 126 219 147 11 30 6 55 -14 75 -27 27 -59 25 -101 -6 -354 -265 -852 -277 -1224 -29 -484 322 -614 983 -290 1470 30 46 55 93 55 104 0 42 -53 72 -98 54z"],["d","M2487 4042 c-33 -36 -22 -73 38 -132 l55 -54 -55 -56 c-63 -63 -73 -106 -33 -134 37 -26 60 -19 120 41 l57 57 60 -57 c65 -62 97 -71 131 -37 34 34 25 66 -37 131 l-57 60 53 51 c59 60 70 88 47 123 -12 18 -25 25 -49 25 -26 0 -43 -11 -87 -55 l-54 -54 -57 54 c-63 60 -102 71 -132 37z"],["d","M3186 4038 c-26 -37 -19 -60 41 -120 l57 -57 -57 -60 c-62 -65 -71 -97 -37 -131 34 -34 66 -25 130 36 l58 56 59 -56 c32 -31 67 -56 78 -56 36 0 65 28 65 63 0 26 -11 43 -55 87 l-55 54 55 56 c60 61 72 102 37 133 -34 31 -69 21 -131 -38 l-57 -54 -54 54 c-62 63 -106 74 -134 33z"],["d","M2923 3350 c-107 -20 -259 -97 -298 -153 -20 -29 -19 -70 3 -90 30 -27 70 -21 115 18 56 48 113 74 205 92 71 14 86 14 156 0 92 -19 147 -44 203 -92 65 -55 133 -40 133 29 0 53 -126 144 -250 180 -68 20 -199 28 -267 16z"],[2,"max-width","max-content","margin","auto"],["size","large","shape","circle","icon","pi pi-gift"]],template:function(t,c){t&1&&(n(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1",6),d(4,Z,1,0,"i",7),l(5," Chats "),o()(),n(6,"div",8)(7,"div",9),d(8,tt,1,0,"router-outlet")(9,yt,7,5,"p-tabs",10),o(),n(10,"div",11),m(11,"router-outlet"),o()()()()),t&2&&(a(4),_(c.shouldShowMobileVersion()?-1:4),a(4),_(c.shouldShowMobileVersion()?8:9))},dependencies:[j,U,H,B,q,O,Q,K,$,z,G,N,k,F,I],styles:["@media (max-width: 575px){.main-container[_ngcontent-%COMP%]{padding-top:2vh!important}}@media (max-width: 767px){.chat-list[_ngcontent-%COMP%]{border-right:0!important;max-width:100%!important}}.go-back-buttom[_ngcontent-%COMP%]{cursor:pointer}#no-data-logo[_ngcontent-%COMP%]{fill:var(--p-tabs-tabpanel-color);width:max-content;height:max-content}.main-container[_ngcontent-%COMP%]{padding:4vh;height:100%}.chat-list[_ngcontent-%COMP%]{border-right:1px solid var(--p-primary-color);min-height:100%;min-width:20vw;max-width:20vw}  .p-tablist-tab-list, .p-tabpanels[_ngcontent-%COMP%], .p-tablist[_ngcontent-%COMP%]{background-color:transparent!important;z-index:0}  .p-dataview-content{border-radius:var(--p-content-border-radius)}  .p-dataview-content.chat-link{cursor:pointer!important}.chat-link[_ngcontent-%COMP%]{cursor:pointer!important}  .p-tabpanels{max-height:100%;overflow:auto}  .p-tabs{max-height:100%}  p-tablist{min-height:max-content;margin-bottom:1rem}  .p-tabpanels{padding-top:0;padding-bottom:0}  .p-divider{margin:0}"]})};export{Y as ChatList};
